import{u as c,r as b,ay as j,j as s,a as l,L as n,bp as G,i as d,o as v,bq as p,h as C,J as D,g as O,I as S,br as Y,bs as U,b2 as W,F as H,bt as B,k as T,K as q,bu as z,a5 as J,a_ as $,ag as M,O as h,bv as V}from"./index-BmPcK3sZ.js";const K={characters:[{id:"1",firstname:"Loaf",lastname:"Scripts",dob:"1990-01-01",phoneNumber:"1234567890",isMale:!0,job:"Developer",height:180,licenses:["Driver's License"],vehicles:[{id:"1",model:"Ubermacht",plate:"ABC123",color:"#ff0000"}],properties:[{id:"1",label:"Groove Street Mansion",address:"Groove st. 3152"}]},{id:"1",firstname:"Breze",lastname:"Scripts",dob:"2000-01-01",phoneNumber:"1234567890",isMale:!0,job:"Developer",height:180,licenses:["Driver's License"],vehicles:[{id:"1",model:"Sentinel",plate:"DEF456",color:"#ff0000"}],properties:[{id:"1",label:"Vinewod Hill Mansion",address:"Vinewood st. 5112"}]}],licenses:["Driver's License","Motorcycle License","Truck License","Pilot's License","Boat License"]};function X(){var f,L,_,F,y,k,x,w;const P=c(N),i=c(o),a=c(r),[R,m]=b.useState(""),A=j(t=>{!P||!(i!=null&&i.avatar)||d.ContextMenu.set({buttons:[{title:n("APPS.REGISTRATION.REMOVE_AVATAR"),color:"red",cb:()=>o.set({...o==null?void 0:o.value,avatar:null})}]})}),I=j(t=>{!P||!(a!=null&&a.picture)||d.ContextMenu.set({buttons:[{title:n("APPS.REGISTRATION.REMOVE_PICTURE"),color:"red",cb:()=>r.set({...r==null?void 0:r.value,picture:null})}]})});return b.useEffect(()=>{i!=null&&i.id||o.set({isMale:!0})},[i==null?void 0:i.id]),s("main",{className:"main",style:{padding:"0"},children:l("div",{className:"grid",children:[l("div",{className:"grid-item profile",children:[s("div",{className:"top",children:s("div",{className:"title",children:n("APPS.REGISTRATION.CHARACTER_INFO")})}),l("div",{className:"profile",children:[l("div",{className:"mugshot",children:[s("img",{...A,"data-hasavatar":!!i.avatar,src:G(i.avatar,"profile"),onClick:()=>{i.avatar&&d.FullscreenImage.set(i.avatar)}}),!(i!=null&&i.avatar)&&P&&s(v.div,{...p,className:"add",onClick:()=>{d.ContextMenu.set({title:n("APPS.POLICE.PROFILES.ADD_AVATAR.TITLE"),buttons:[{title:n("APPS.POLICE.PROFILES.ADD_AVATAR.SET_PHOTO"),cb:()=>{var t,e,E;d.Gallery.set({includeVideos:!1,allowExternal:(E=(e=(t=C)==null?void 0:t.value)==null?void 0:e.AllowExternal)==null?void 0:E.Registration,onSelect:u=>{o.set({...o==null?void 0:o.value,avatar:u.src})}})}},{title:n("APPS.POLICE.PROFILES.ADD_AVATAR.PASTE_URL"),cb:()=>{let t="";d.PopUp.set({title:n("APPS.POLICE.PROFILES.ADD_AVATAR.PASTE_URL"),description:n("APPS.POLICE.PROFILES.ADD_AVATAR.PASTE_URL_DESCRIPTION"),input:{placeholder:n("APPS.POLICE.PROFILES.ADD_AVATAR.PASTE_URL_PLACEHOLDER"),minCharacters:5,maxCharacters:500,onChange:e=>{t=e}},buttons:[{title:n("APPS.POLICE.CANCEL")},{title:n("APPS.POLICE.SAVE"),cb:()=>{let e=t;e.match(/\.(jpeg|jpg|gif|png)$/)!=null&&e.match(/http(s?):\/\//)!=null?o.set({...o==null?void 0:o.value,avatar:e}):(D("error","Invalid URL / Invalid image URL"),setTimeout(()=>{d.PopUp.set({title:n("APPS.POLICE.PROFILES.ADD_AVATAR.INVALID_URL"),description:n("APPS.POLICE.PROFILES.ADD_AVATAR.INVALID_URL_DESCRIPTION"),buttons:[{title:n("APPS.POLICE.PROFILES.ADD_AVATAR.OK")}]})},500))}}]})}}]})},children:s(O,{})})]}),s("div",{className:"info",children:l("div",{className:"name",children:[i==null?void 0:i.firstname," ",i==null?void 0:i.lastname]})}),l("div",{className:"details",children:[l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.FIRSTNAME"),":"]}),P?s(S,{type:"text",value:(i==null?void 0:i.firstname)??"",onChange:t=>{o.set({...o==null?void 0:o.value,firstname:t.target.value})}}):s("div",{className:"value",children:i==null?void 0:i.firstname})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.LASTNAME"),":"]}),P?s(S,{type:"text",value:(i==null?void 0:i.lastname)??"",onChange:t=>{o.set({...o==null?void 0:o.value,lastname:t.target.value})}}):s("div",{className:"value",children:i==null?void 0:i.lastname})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.DOB"),":"]}),P?s(S,{type:"text",value:(i==null?void 0:i.dob)??((f=C.value)==null?void 0:f.DobFormat),onChange:t=>{o.set({...o==null?void 0:o.value,dob:t.target.value})}}):l("div",{className:"value",children:[(i==null?void 0:i.dob)??n("APPS.POLICE.MISC.UNKNOWN"),(i==null?void 0:i.dob)&&l("span",{children:["(",Y(i==null?void 0:i.dob),")"]})]})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.PHONE_NUMBER"),":"]}),P?s(S,{type:"text",value:(i==null?void 0:i.phoneNumber)??"",onChange:t=>{o.set({...o==null?void 0:o.value,phoneNumber:t.target.value})}}):s("div",{className:U("value",(i==null?void 0:i.phoneNumber)&&"blue"),children:i!=null&&i.phoneNumber?W(i==null?void 0:i.phoneNumber):n("APPS.POLICE.MISC.UNKNOWN")})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.GENDER"),":"]}),P?l("select",{onChange:t=>{o.set({...o==null?void 0:o.value,isMale:t.target.value==="true"})},children:[s("option",{value:"true",selected:i==null?void 0:i.isMale,children:n("APPS.REGISTRATION.MALE")}),s("option",{value:"false",selected:!(i!=null&&i.isMale),children:n("APPS.REGISTRATION.FEMALE")})]}):s("div",{className:"value",children:i.isMale?n("APPS.POLICE.PROFILES.MALE"):n("APPS.POLICE.PROFILES.FEMALE")})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.JOB"),":"]}),s("div",{className:"value",children:P?s(S,{type:"text",value:i==null?void 0:i.job,onChange:t=>{o.set({...o==null?void 0:o.value,job:t.target.value})}}):s("div",{className:"value",children:i==null?void 0:i.job})})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.HEIGHT"),":"]}),P?s(S,{type:"number",value:i==null?void 0:i.height,onChange:t=>{o.set({...o==null?void 0:o.value,height:parseInt(t.target.value)})}}):i!=null&&i.height?s("div",{className:"value",children:n("APPS.REGISTRATION.FORMATTED_HEIGHT",{height:(L=i==null?void 0:i.height)==null?void 0:L.toString()})}):s("div",{className:"value",children:n("APPS.POLICE.MISC.UNKNOWN")})]})]})]})]}),s("div",{className:"grid-item full",children:a?l(H,{children:[l("div",{className:"top",children:[s("div",{className:"title",children:n("APPS.REGISTRATION.VEHICLE")}),l("div",{className:"buttons",children:[a!=null&&a.id?l("div",{className:"button red",onClick:()=>{},children:[s(B,{}),n("APPS.REGISTRATION.DELETE")]}):l("div",{className:"button red",onClick:()=>{r.set(null),N.set(!1)},children:[s(B,{}),n("APPS.REGISTRATION.CANCEL")]}),l("div",{className:"button",onClick:()=>{var t;if(!a.model||!a.plate||!a.color)return D("error","Missing required fields");T("Registration",{action:"saveVehicle",id:i.id,data:a},(a==null?void 0:a.id)??(((t=i==null?void 0:i.vehicles)==null?void 0:t.length)??0)+1).then(e=>{var E;if(!e)return console.error("Failed to save vehicle");a.id?o.patch({vehicles:(E=i.vehicles)==null?void 0:E.map(u=>u.id===a.id?a:u)}):o.patch({vehicles:[...i.vehicles??[],{...a,id:e}]}),r.set(null)})},children:[s(O,{}),n("APPS.REGISTRATION.SAVE")]})]})]}),l("div",{className:"profile",children:[l("div",{className:"mugshot",children:[s("img",{...I,"data-hasavatar":!!a.picture,src:G(a.picture,"vehicle"),onClick:()=>{a.picture&&d.FullscreenImage.set(a.picture)}}),!(a!=null&&a.picture)&&P&&s(v.div,{...p,className:"add",onClick:()=>{d.ContextMenu.set({title:n("APPS.POLICE.VEHICLES.ADD_PHOTO.TITLE"),buttons:[{title:n("APPS.POLICE.VEHICLES.ADD_PHOTO.SET_PHOTO"),cb:()=>{var t,e,E;d.Gallery.set({includeVideos:!1,allowExternal:(E=(e=(t=C)==null?void 0:t.value)==null?void 0:e.AllowExternal)==null?void 0:E.Registration,onSelect:u=>{r.set({...r==null?void 0:r.value,picture:u.src})}})}},{title:n("APPS.POLICE.VEHICLES.ADD_PHOTO.PASTE_URL"),cb:()=>{let t="";d.PopUp.set({title:n("APPS.POLICE.VEHICLES.ADD_PHOTO.PASTE_URL"),description:n("APPS.POLICE.VEHICLES.ADD_PHOTO.PASTE_URL_DESCRIPTION"),input:{placeholder:n("APPS.POLICE.VEHICLES.ADD_PHOTO.PASTE_URL_PLACEHOLDER"),minCharacters:5,maxCharacters:500,onChange:e=>{t=e}},buttons:[{title:n("APPS.POLICE.CANCEL")},{title:n("APPS.POLICE.SAVE"),cb:()=>{let e=t;e.match(/\.(jpeg|jpg|gif|png)$/)!=null&&e.match(/http(s?):\/\//)!=null?r.set({...r==null?void 0:r.value,picture:e}):(D("error","Invalid URL / Invalid image URL"),setTimeout(()=>{d.PopUp.set({title:n("APPS.POLICE.VEHICLES.ADD_PHOTO.INVALID_URL"),description:n("APPS.POLICE.VEHICLES.ADD_PHOTO.INVALID_URL_DESCRIPTION"),buttons:[{title:n("APPS.POLICE.VEHICLES.ADD_PHOTO.OK")}]})},500))}}]})}}]})},children:s(O,{})})]}),s("div",{className:"info",children:s("div",{className:"name",children:a==null?void 0:a.model})}),l("div",{className:"details",children:[l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.MODEL"),":"]}),!(a!=null&&a.id)||P?s(S,{type:"text",value:(a==null?void 0:a.model)??"",onChange:t=>{r.set({...r==null?void 0:r.value,model:t.target.value})}}):s("div",{className:"value",children:a==null?void 0:a.model})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.PLATE"),":"]}),!(a!=null&&a.id)||P?s(S,{type:"text",value:(a==null?void 0:a.plate)??"",onChange:t=>{r.set({...r==null?void 0:r.value,plate:t.target.value})}}):s("div",{className:"value",children:a==null?void 0:a.plate})]}),l("div",{className:"item",children:[l("span",{children:[n("APPS.REGISTRATION.COLOR"),":"]}),s("div",{className:"value",children:s("div",{className:"color",style:{backgroundColor:(a==null?void 0:a.color)??"rgb(0,0,0)",cursor:!(a!=null&&a.id)||P?"pointer":"default"},onClick:()=>{!P&&(a!=null&&a.id)||d.ColorPicker.set({defaultColor:a==null?void 0:a.color,onSelect:t=>{r.set({...r==null?void 0:r.value,color:t})}})}})})]})]}),(a==null?void 0:a.id)&&s("div",{className:"button red",onClick:()=>{d.PopUp.set({title:n("APPS.REGISTRATION.DELETE_VEHICLE_POPUP.TITLE"),description:n("APPS.REGISTRATION.DELETE_VEHICLE_POPUP.DESCRIPTION"),buttons:[{title:n("APPS.REGISTRATION.CANCEL")},{title:n("APPS.REGISTRATION.DELETE"),color:"red",cb:()=>{T("Registration",{action:"deleteVehicle",characterId:i.id,vehicleId:a.id},!0).then(t=>{if(!t)return console.error("Failed to delete vehicle");o.patch({vehicles:i.vehicles.filter(e=>e.id!==a.id)}),r.set(null),N.set(!1)})}}]})},children:n("APPS.REGISTRATION.DELETE_VEHICLE")})]})]}):l(H,{children:[l("div",{className:"top",children:[s("div",{className:"title",children:n("APPS.REGISTRATION.VEHICLES")}),(i==null?void 0:i.id)&&l("div",{className:"button",onClick:()=>{r.set({})},children:[s(O,{}),n("APPS.REGISTRATION.CREATE")]})]}),s(q,{placeholder:n("APPS.REGISTRATION.SEARCH_VEHICLES"),onChange:t=>m(t.target.value)}),s("div",{className:"items",children:(F=(_=i==null?void 0:i.vehicles)==null?void 0:_.filter(t=>{var e,E;return((e=t==null?void 0:t.model)==null?void 0:e.toLowerCase().includes(R==null?void 0:R.toLowerCase()))||((E=t==null?void 0:t.plate)==null?void 0:E.toLowerCase().includes(R.toLowerCase()))}))==null?void 0:F.map(t=>l(v.div,{...z,className:"item home",onClick:()=>{r.set(t),N.set(!0)},children:[s("img",{src:G(t.picture,"vehicle")}),l("div",{className:"item-content",children:[l("div",{className:"item-title",children:[t.model,s("div",{className:"color",style:{backgroundColor:t.color}})]}),s("div",{className:"item-subtitle",children:t.model})]})]},t.id))})]})}),s("div",{className:"grid-item",children:l("div",{className:"grid vertical",children:[l("div",{className:"grid-item half",children:[l("div",{className:"top",children:[s("div",{className:"title",children:n("APPS.REGISTRATION.LICENSES")}),(i==null?void 0:i.id)&&l(v.div,{...p,className:"button",onClick:()=>{T("Registration",{action:"getLicenses"},K.licenses).then(t=>{if(!t)return D("error","No licenses were returned");d.ContextMenu.set({title:n("APPS.REGISTRATION.ADD_LICENSE"),buttons:t==null?void 0:t.map(e=>({title:e,cb:()=>{T("Registration",{action:"addLicense",id:i.id,license:e},!0).then(E=>{if(!E)return console.error("Failed to save license");o.patch({licenses:[...(i==null?void 0:i.licenses)??[],e]})})}}))})})},children:[s(O,{}),n("APPS.REGISTRATION.ADD")]})]}),s("div",{className:"items",children:l("div",{className:"cards",children:[(!(i!=null&&i.licenses)||((y=i==null?void 0:i.licenses)==null?void 0:y.length)===0)&&s("div",{className:"no-results",children:n("APPS.POLICE.PROFILES.LICENSES.NO_LICENSES")}),(k=i==null?void 0:i.licenses)==null?void 0:k.map((t,e)=>s("div",{className:U("card blue",P&&"clickable"),onClick:()=>{P&&d.PopUp.set({title:n("APPS.REGISTRATION.DELETE_LICENSE_POPUP.TITLE"),description:n("APPS.REGISTRATION.DELETE_LICENSE_POPUP.DESCRIPTION"),buttons:[{title:n("APPS.REGISTRATION.CANCEL")},{title:n("APPS.REGISTRATION.DELETE"),color:"red",cb:()=>{T("Registration",{action:"deleteLicense",id:i.id,license:t},!0).then(E=>{if(!E)return console.error("Failed to delete property");o.patch({licenses:i.licenses.filter(u=>u!==t)})})}}]})},children:t},e))]})})]}),l("div",{className:"grid-item half",children:[l("div",{className:"top",children:[s("div",{className:"title",children:n("APPS.REGISTRATION.PROPERTIES")}),(i==null?void 0:i.id)&&l(v.div,{...p,className:"button",onClick:()=>{let t={label:"",address:""};d.PopUp.set({title:n("APPS.REGISTRATION.ADD_PROPERTY_POPUP.TITLE"),description:n("APPS.REGISTRATION.ADD_PROPERTY_POPUP.DESCRIPTION"),inputs:[{placeholder:n("APPS.REGISTRATION.ADD_PROPERTY_POPUP.LABEL"),onChange:e=>{t.label=e}},{placeholder:n("APPS.REGISTRATION.ADD_PROPERTY_POPUP.ADDRESS"),onChange:e=>{t.address=e}}],buttons:[{title:n("APPS.REGISTRATION.CANCEL")},{title:n("APPS.REGISTRATION.SAVE"),cb:()=>{var e;T("Registration",{action:"addProperty",id:i.id,data:t},(((e=i==null?void 0:i.properties)==null?void 0:e.length)??0)+1).then(E=>{if(!E)return console.error("Failed to save property");o.patch({properties:[...(i==null?void 0:i.properties)??[],{...t,id:E}]})})}}]})},children:[s(O,{}),n("APPS.REGISTRATION.ADD")]})]}),s("div",{className:"items",children:l("div",{className:"cards",children:[(!(i!=null&&i.properties)||((x=i==null?void 0:i.properties)==null?void 0:x.length)===0)&&s("div",{className:"no-results",children:n("APPS.POLICE.PROFILES.NO_PROPERTIES")}),(w=i==null?void 0:i.properties)==null?void 0:w.map((t,e)=>l("div",{className:U("card blue",P&&"clickable"),onClick:()=>{P&&d.PopUp.set({title:n("APPS.REGISTRATION.DELETE_PROPERTY_POPUP.TITLE"),description:n("APPS.REGISTRATION.DELETE_PROPERTY_POPUP.DESCRIPTION"),buttons:[{title:n("APPS.REGISTRATION.CANCEL")},{title:n("APPS.REGISTRATION.DELETE"),color:"red",cb:()=>{T("Registration",{action:"deleteProperty",id:i.id,propertyId:t.id},!0).then(E=>{if(!E)return console.error("Failed to delete property");o.patch({properties:i.properties.filter(u=>u.id!==t.id)})})}}]})},children:[t.label," ",t.address&&`(${t.address})`]},e))]})})]}),l("div",{className:"grid-item full",children:[s("div",{className:"top",children:s("div",{className:"title",children:n("APPS.REGISTRATION.DESCRIPTION")})}),s("div",{className:"items",children:s(J,{className:"note",placeholder:n("APPS.REGISTRATION.DESCRIPTION_PLACEHOLDER"),disabled:!P,style:{height:"100%"},value:i==null?void 0:i.description,onChange:t=>{o.set({...o==null?void 0:o.value,description:t.target.value})}})})]})]})})]})})}function Q(){const P=c(g),i=c(o),a=c(N),R=()=>{let A=["firstname","lastname","dob","height","job"];if(!A.every(I=>i[I])){d.PopUp.set({title:n("APPS.REGISTRATION.ERROR.TITLE"),description:n("APPS.REGISTRATION.ERROR.MISSING_FIELDS",{fields:A.filter(I=>!i[I]).map(I=>n(`APPS.REGISTRATION.${I.toUpperCase()}`)).join(", ")}),buttons:[{title:n("APPS.REGISTRATION.ERROR.OK")}]});return}T("Registration",{action:"saveCharacter",data:i},!0).then(I=>{if(!I)return console.error("Failed to save character");if(i.id){const f=P.findIndex(L=>L.id===i.id);g.set(g.value.map((L,_)=>_===f?i:L))}else g.set([...P,{...i,id:I}]),o.set({...i,id:I});N.set(!1)})},m=()=>{T("Registration",{action:"deleteCharacter",id:i.id},!0).then(A=>{if(!A)return console.error("Failed to delete character");g.set(P.filter(I=>I.id!==i.id)),o.set(null),N.set(!1)})};return l("header",{className:"registration-header",children:[l("div",{className:"selected-character",children:[s(Z,{title:i!=null&&i.firstname&&(i!=null&&i.lastname)?`${i==null?void 0:i.firstname} ${i==null?void 0:i.lastname}`:n("APPS.REGISTRATION.SELECT_CHARACTER"),items:(P==null?void 0:P.map(A=>({title:`${A.firstname} ${A.lastname}`,icon:s($,{}),onSelect:()=>o.set(A)})))||[]}),l("div",{className:"button",onClick:()=>{N.set(!0),o.set({})},children:[s(O,{}),n("APPS.REGISTRATION.CREATE_NEW")]})]}),s("div",{className:"buttons",children:s(M,{children:i&&(a?l(H,{children:[s("div",{...p,className:"button",onClick:R,children:n("APPS.REGISTRATION.SAVE")}),i.id&&s("div",{...p,className:"button red",onClick:m,children:n("APPS.REGISTRATION.DELETE_CHARACTER")})]}):s("div",{...p,className:"button",onClick:()=>N.set(!a),children:n("APPS.REGISTRATION.EDIT")}))})})]})}const N=h(!0),g=h([]),o=h(null),r=h(null);function ni(){const P=c(o);return b.useEffect(()=>{T("Registration",{action:"getCharacters"},K.characters).then(i=>{if(!i)return D("error","No characters were returned");D("info","Receiving characters:",i),g.set(i)})},[]),b.useEffect(()=>{P!=null&&P.id&&N.set(!1)},[P==null?void 0:P.id]),l("div",{className:"registration-container",children:[s(Q,{}),s("main",{children:s("div",{className:"main-container",children:s(M,{children:s("div",{className:"main-wrapper",children:s(v.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{ease:"easeInOut",duration:.25},className:"registration-container",children:P?s(X,{}):s("div",{className:"select-character",children:n("APPS.REGISTRATION.PLEASE_SELECT_CHARACTER")})})})})})})]})}const Z=({title:P,items:i})=>{const[a,R]=b.useState(!1);return l("a",{className:"dropdown",onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),children:[l("div",{className:"dropdown-info",children:[s($,{}),P]}),s(V,{}),s(M,{children:a&&i.length>0&&s(v.div,{className:"dropdown-content",initial:{opacity:0,y:-10,transform:"translateX(-50%)"},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15,ease:"easeInOut"},children:i.map((m,A)=>l(v.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.1,ease:"easeInOut",delay:A*.025},className:"dropdown-item",onClick:()=>{m.onSelect(),R(!1)},children:[m.icon&&m.icon,m.title]},A))})})]})};export{g as Characters,Z as Dropdown,N as EditMode,o as SelectedCharacter,r as SelectedVehicle,ni as default};
