import{u as g,r as S,W as I,a1 as l,J as h,k as p,a2 as F,j as t,F as x,a as c,o as v,p as m,L as r,K as y,a3 as O,a4 as B,N as U,I as M,a5 as X,a6 as j,i as A,a7 as H,O as K,a8 as V}from"./index-BmPcK3sZ.js";const W={tablet:[{id:"414",title:"Citation",content:`Citation for Benefactor Kriger

Plate: 4X4X4X4

Offence: Speeding

Fine: $500`},{id:"1661",title:"Police Briefing",content:`Today we will be focusing on the following:

- Traffic stops
- Drug busts
- Bank robberies`}],phone:[{id:"123",title:"Shopping List",content:"Milk, eggs, bread, butter",updated_at:Date.now()-1e3*60*60*2},{id:"1414",title:"To Do List",content:`- Finish the UI
- Implement the backend
- Deploy the app`,updated_at:Date.now()-1e3*60*60*5},{id:"51515",title:"another list",content:`this is yet another list, it functions as a test for the notes app.

You can add new notes, edit them, and delete them.`,updated_at:Date.now()-1e3*60*60*24*2}]},s=K([]);function J(){var E;const C=g(V),d=g(s),[n,u]=S.useState(null),[i,P]=S.useState("tablet"),[N,b]=S.useState("");S.useEffect(()=>{if(I("Notes")){if(s.set([]),l.APPS.NOTES.notes.value&&l.APPS.NOTES.notes.value.length>0&&i==="tablet"){h("info","Using cached notes, not fetching",l.APPS.NOTES.notes.value),s.set(l.APPS.NOTES.notes.value);return}h("info","Fetching notes, from device: ",i),p("Notes",{action:"fetch"},W[i],i==="phone").then(e=>{if(!e)return h("warning","Failed to fetch notes, server returned false");h("info","Fetched notes",e),s.set(e),i==="tablet"&&l.APPS.NOTES.notes.set(e)})}},[i]),S.useEffect(()=>{P("tablet")},[n]);const{handleScroll:w}=F({fetchData:e=>p("Notes",{action:"fetch",page:e}),onDataFetched:e=>()=>{h("info","Fetched notes from progressive scrolling",e),s.set([...d,...e]),l.APPS.NOTES.notes.set([...d,...e])},perPage:15}),D=()=>{let e=Math.floor(Date.now()),a={title:r("APPS.NOTES.NEW_NOTE"),content:"",updated_at:e};p("Notes",{action:"create",data:a},!0).then(o=>{a.id=o,u(a),s.set([...d,a]),l.APPS.NOTES.notes.set([...d,a])})},k=e=>{let a=Math.floor(Date.now()),o=[...d],T=o.findIndex(_=>_.id===e),f=o[T];f={id:n.id,title:n.title,content:n.content,updated_at:a},o[T]=f,p("Notes",{action:"save",data:f},!0),u(null),s.set(o),l.APPS.NOTES.notes.set(o)},L=e=>{p("Notes",{action:"remove",id:e},!0).then(a=>{if(!a)return h("warning","Could not remove note with id: "+e);h("info","Successfully removed note with id: "+e),u(null),s.set(s.value.filter(o=>o.id!==e)),l.APPS.NOTES.notes.set(s.value.filter(o=>o.id!==e))})};return t(x,{children:t("div",{className:"notes-container",children:n?c(v.div,{...m("right","note",.2),className:"notes-wrapper note",children:[c("div",{className:"top",children:[c("div",{className:"back",onClick:()=>k(n.id),children:[t(U,{}),r("APPS.NOTES.TITLE")]}),t(M,{className:"title",defaultValue:n.title,onChange:e=>u({...n,title:e.target.value})}),t("div",{})]}),t(X,{onChange:e=>u({...n,content:e.target.value}),defaultValue:n.content}),c("div",{className:"notes-bottom",children:[t("div",{className:"action left",children:t(j,{onClick:()=>A.PopUp.set({title:r("APPS.NOTES.DELETE_TITLE",{title:n.title}),description:r("APPS.NOTES.DELETE_TEXT",{title:n.title}),buttons:[{title:r("APPS.NOTES.BUTTON_CANCEL")},{title:r("APPS.NOTES.BUTTON_DELETE"),color:"red",cb:()=>L(n.id)}]})})}),t("div",{className:"amount",children:r("APPS.NOTES.LAST_EDITED",{date:O(n.updated_at)})}),t("div",{className:"action",children:t(H,{onClick:()=>{A.Share.set({type:"note",data:n})}})})]})]}):c(v.div,{...m("left","notes",.2),className:"notes-wrapper ",children:[c("div",{className:"notes-header",children:[t("div",{className:"title",children:"Notes"}),C&&t("div",{className:"selector",children:["tablet","phone"].map((e,a)=>t("div",{onClick:()=>P(e),className:"option","data-active":i===e,children:r(`APPS.NOTES.${e==null?void 0:e.toUpperCase()}`)},a))})]}),t(y,{placeholder:"Search notes",onChange:e=>b(e.target.value)}),t("div",{className:"notes-body",onScroll:w,children:t(v.div,{...m(i==="tablet"?"left":"right",i,.2),className:"notes-list",children:d.filter(e=>{var a,o;return((a=e.title)==null?void 0:a.toLowerCase().includes(N==null?void 0:N.toLowerCase()))||((o=e.content)==null?void 0:o.toLowerCase().includes(N==null?void 0:N.toLowerCase()))}).sort((e,a)=>a.updated_at-e.updated_at).map((e,a)=>c("div",{className:"note-item",onClick:()=>u(e),children:[t("div",{className:"note-title",children:e.title}),c("div",{className:"note-details",children:[t("div",{className:"date",children:O(e.updated_at)}),t("div",{className:"content",children:e.content.length>30?e.content.slice(0,30)+"...":e.content})]})]},a))})}),c("div",{className:"notes-bottom",children:[t("div",{}),t("div",{className:"amount",children:r("APPS.NOTES.FOOTER",{amount:(E=d.length)==null?void 0:E.toString()})}),t("div",{className:"action",children:t(B,{onClick:()=>D()})})]})]})})})}export{J as default};
